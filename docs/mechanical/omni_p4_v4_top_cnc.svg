<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="-50 -120 600 500" width="600mm" height="500mm">
  <title>OMNI-P4 v4.1 Top/Bottom Panel CNC Pattern</title>
  <desc>上面/底面パネル (120°扇形) - B&amp;W Formation Wedge準拠 - Scale 1:1</desc>

  <style>
    .cut { fill: none; stroke: #f00; stroke-width: 0.5; }
    .engrave { fill: none; stroke: #00f; stroke-width: 0.3; }
    .dimension { fill: none; stroke: #000; stroke-width: 0.2; }
    .dim-text { font-family: Arial, sans-serif; font-size: 8px; fill: #000; }
    .title { font-family: Arial, sans-serif; font-size: 12px; font-weight: bold; fill: #000; }
    .subtitle { font-family: Arial, sans-serif; font-size: 8px; fill: #000; }
    .annotation { font-family: Arial, sans-serif; font-size: 6px; fill: #333; }
    .calc { font-family: Arial, sans-serif; font-size: 5px; fill: #006600; font-style: italic; }
    .center { fill: none; stroke: #0a0; stroke-width: 0.2; stroke-dasharray: 5,3; }
    .construction { fill: none; stroke: #999; stroke-width: 0.15; stroke-dasharray: 2,2; }
    .angle-arc { fill: none; stroke: #c00; stroke-width: 0.3; }
    .bw-ref { font-family: Arial, sans-serif; font-size: 6px; fill: #0066cc; font-weight: bold; }
  </style>

  <!-- Title Block -->
  <text x="270" y="-90" class="title" text-anchor="middle">上面/底面パネル CNC切削パターン v4.1</text>
  <text x="270" y="-75" class="subtitle" text-anchor="middle">TOP/BOTTOM PANEL - 120° SECTOR (Scale 1:1)</text>
  <text x="270" y="-60" class="bw-ref" text-anchor="middle">B&amp;W Formation Wedge準拠: 440mm × 243mm</text>
  <text x="270" y="-45" class="annotation" text-anchor="middle">Material: 12mm MDF | Quantity: 2 | RED = Cut Line</text>

  <!--
    B&amp;W Geometry:
    - Front width = 440mm
    - Depth = 243mm
    - Sector angle = 120°
    - R (front radius) = 440 / (2 × sin(60°)) = 254.0mm
    - r (back radius) = 254 - 243 = 11mm
    - Back width = 2 × 11 × sin(60°) = 19mm

    SVG coordinates:
    - Virtual apex at (270, 297) [center X, apex Y]
    - Front arc at Y = 297 - 254 = 43
    - Back arc at Y = 297 - 11 = 286
    - Front half-width = 254 × sin(60°) = 220mm → X = 50 to 490
    - Back half-width = 11 × sin(60°) = 9.5mm → X = 260.5 to 279.5
  -->

  <!-- Virtual apex point (construction) -->
  <circle cx="270" cy="297" r="2" fill="#999"/>
  <text x="280" y="305" class="calc">頂点</text>

  <!-- Construction lines showing 120° angle -->
  <line x1="270" y1="297" x2="50" y2="43" class="construction"/>
  <line x1="270" y1="297" x2="490" y2="43" class="construction"/>

  <!-- 120° angle arc at apex -->
  <path d="M 240,267 A 40,40 0 0,1 300,267" class="angle-arc"/>
  <text x="270" y="258" class="dim-text" text-anchor="middle" fill="#c00">120°</text>

  <!-- Center line -->
  <line x1="270" y1="25" x2="270" y2="315" class="center"/>

  <!-- ==================== MAIN SECTOR SHAPE (CUT) ==================== -->
  <path d="M 50,43
           A 254,254 0 0,1 490,43
           L 279.5,286
           A 11,11 0 0,0 260.5,286
           Z" class="cut"/>

  <!-- ==================== MIC OPENING (CUT) - for top panel only ==================== -->
  <!-- Ø60mm at center, positioned at approximately 1/3 depth from back -->
  <circle cx="270" cy="150" r="30" class="cut"/>
  <text x="270" y="155" class="annotation" text-anchor="middle">Ø60 MIC</text>
  <text x="270" y="168" class="calc" text-anchor="middle">(Top panel only)</text>

  <!-- ==================== DIMENSIONS ==================== -->

  <!-- Front width (chord) 440mm -->
  <line x1="50" y1="25" x2="490" y2="25" class="dimension"/>
  <line x1="50" y1="43" x2="50" y2="20" class="dimension"/>
  <line x1="490" y1="43" x2="490" y2="20" class="dimension"/>
  <polygon points="50,25 58,22 58,28" fill="#000"/>
  <polygon points="490,25 482,22 482,28" fill="#000"/>
  <text x="270" y="13" class="dim-text" text-anchor="middle">440 (B&amp;W公式)</text>

  <!-- Back width (chord) 19mm -->
  <line x1="260.5" y1="303" x2="279.5" y2="303" class="dimension"/>
  <line x1="260.5" y1="286" x2="260.5" y2="308" class="dimension"/>
  <line x1="279.5" y1="286" x2="279.5" y2="308" class="dimension"/>
  <text x="270" y="320" class="dim-text" text-anchor="middle">19</text>

  <!-- Depth 243mm -->
  <line x1="510" y1="43" x2="510" y2="286" class="dimension"/>
  <line x1="490" y1="43" x2="515" y2="43" class="dimension"/>
  <line x1="279.5" y1="286" x2="515" y2="286" class="dimension"/>
  <polygon points="510,43 507,51 513,51" fill="#000"/>
  <polygon points="510,286 507,278 513,278" fill="#000"/>
  <text x="525" y="170" class="dim-text" text-anchor="start">243 (B&amp;W公式)</text>

  <!-- Front radius 254mm -->
  <line x1="270" y1="297" x2="490" y2="43" class="dimension"/>
  <text x="400" y="190" class="dim-text" transform="rotate(-60, 400, 190)">R = 254</text>

  <!-- Back radius 11mm -->
  <line x1="270" y1="297" x2="279.5" y2="286" class="dimension"/>
  <text x="285" y="295" class="dim-text">r = 11</text>

  <!-- Mic position from apex -->
  <line x1="535" y1="150" x2="535" y2="286" class="dimension"/>
  <line x1="270" y1="150" x2="540" y2="150" class="dimension"/>
  <text x="545" y="223" class="dim-text" text-anchor="start">147</text>
  <text x="545" y="236" class="calc" text-anchor="start">(MIC位置)</text>

  <!-- ==================== GEOMETRY CALCULATIONS BOX ==================== -->
  <rect x="-40" y="330" width="260" height="110" fill="#fffff0" stroke="#999" stroke-width="0.3"/>
  <text x="90" y="345" class="subtitle" text-anchor="middle">幾何学計算 (B&amp;W準拠)</text>

  <text x="-30" y="362" class="calc">【120°扇形パラメータ】</text>
  <text x="-25" y="375" class="calc">θ = 120° = 2π/3 rad</text>
  <text x="-25" y="387" class="calc">弦長 = 2R·sin(θ/2) = 2R·sin(60°) = 1.732R</text>
  <text x="-25" y="399" class="calc">前面幅: 440 = 1.732R → R = 254.0mm</text>
  <text x="-25" y="411" class="calc">奥行き: 243mm (B&amp;W公式)</text>
  <text x="-25" y="423" class="calc">背面半径: r = 254 - 243 = 11mm</text>
  <text x="-25" y="435" class="calc">背面幅 = 2 × 11 × sin(60°) = 19mm</text>

  <!-- ==================== CNC NOTES BOX ==================== -->
  <rect x="240" y="330" width="160" height="110" fill="#f0fff0" stroke="#999" stroke-width="0.3"/>
  <text x="320" y="345" class="subtitle" text-anchor="middle">CNC NOTES</text>

  <text x="250" y="365" class="calc">• Material: 12mm MDF</text>
  <text x="250" y="378" class="calc">• Quantity: 2 (Top + Bottom)</text>
  <text x="250" y="391" class="calc">• Tool: 6mm endmill</text>
  <text x="250" y="404" class="calc">• Tolerance: ±0.5mm</text>
  <text x="250" y="417" class="calc">• MIC hole: Top panel only</text>
  <text x="250" y="430" class="calc">• Arc: Circular interpolation</text>

  <!-- Origin mark -->
  <circle cx="50" cy="43" r="3" class="engrave"/>
  <line x1="42" y1="43" x2="58" y2="43" class="engrave"/>
  <line x1="50" y1="35" x2="50" y2="51" class="engrave"/>
  <text x="35" y="58" class="annotation" text-anchor="end">ORIGIN</text>
</svg>
